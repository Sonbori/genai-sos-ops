# 1Pager: 오프라인 큐잉 PWA + 재연결 배달

## Problem
재난 상황에서 통신 인프라가 불안정하거나 완전히 차단될 때, 시민들이 긴급 신고를 할 수 없는 상황이 발생합니다. 기존 모든 긴급 신고 시스템은 온라인 연결을 전제로 하여, 재난 시 가장 중요한 순간에 사용할 수 없습니다.

## Today's Alternatives
- **기존 119/112 시스템**: 전화 기반, 통신 불안정 시 사용 불가
- **모바일 앱 기반 신고**: 온라인 연결 필수, 재난 시 서비스 중단
- **SMS 기반 신고**: 문자 메시지 전송 실패 가능성 높음

**근거 링크**: 
- [한전KDN 재난대피로 안내 플랫폼](https://www.dailian.co.kr/news/view/1400947) - 온라인 연결 전제
- [ETRI 119신고 시스템](https://ettrends.etri.re.kr/ettrends/202/0905202007/0905202007.html) - 음성 인식만 지원

## Proposed Solution

### 아키텍처 다이어그램
```
[사용자 디바이스] 
    ↓ (오프라인)
[Service Worker] → [IndexedDB] → [로컬 큐잉]
    ↓ (재연결 시)
[암호화 전송] → [Supabase] → [상황실 대시보드]
```

### 핵심 기능
1. **완전 오프라인 우선**: 네트워크 없이도 신고 접수 가능
2. **자동 재연결**: 네트워크 복구 시 자동으로 대기열 전송
3. **암호화 보안**: 로컬 저장 및 전송 시 AES-256 암호화
4. **우선순위 큐잉**: 위험도에 따른 전송 우선순위 관리

## User/Buyer
- **주요 구매자**: 지자체, 대형 행사 주최사, 산업현장 HSE
- **사용자**: 시민, 행사 참가자, 현장 작업자
- **결정권자**: 재난관리책임자, 행사 안전관리자

## KPIs
- **탐지정확도**: 95% (오프라인 상태에서도 신고 접수)
- **평균 처리시간**: 30초 (재연결 시 자동 전송)
- **제출→관제까지 지연**: 5분 이내 (네트워크 복구 시)
- **사용자 만족도**: 90% 이상

## Data & Privacy
- **수집 데이터**: 신고 내용, 위치 정보, 타임스탬프
- **로컬 저장**: IndexedDB에 암호화하여 저장
- **전송 시**: AES-256 암호화 후 전송
- **보존 기간**: 30일 (로컬), 1년 (서버)

## Risks & Mitigations
| 위험 | 완화 방안 |
|------|-----------|
| 로컬 저장소 용량 부족 | 압축 알고리즘 + 자동 정리 |
| 암호화 키 유실 | 디바이스별 고유 키 생성 |
| 재연결 실패 | 지수 백오프 + 수동 재시도 |
| 데이터 손실 | 로컬 백업 + 클라우드 동기화 |

## 4주 PoC 스코프
### Week 1: 기본 오프라인 큐잉
- Service Worker 구현
- IndexedDB 로컬 저장
- 기본 신고 접수 UI

### Week 2: 암호화 및 보안
- AES-256 암호화 구현
- 디바이스별 키 관리
- 보안 테스트

### Week 3: 재연결 및 동기화
- 네트워크 상태 감지
- 자동 재연결 로직
- 우선순위 큐잉

### Week 4: 통합 테스트 및 최적화
- 전체 플로우 테스트
- 성능 최적화
- 사용자 테스트

## 성공판정 기준
1. **기능성**: 오프라인 상태에서 신고 접수 가능
2. **안정성**: 99% 이상 재연결 성공률
3. **보안성**: 암호화 검증 통과
4. **사용성**: 직관적인 UI/UX
5. **성능**: 5초 이내 신고 접수 완료

## 기술 스택
- **Frontend**: PWA, Service Worker, IndexedDB
- **Backend**: Supabase, PostgreSQL
- **암호화**: Web Crypto API, AES-256
- **모니터링**: 실시간 연결 상태 추적

## 예상 비용
- **개발 비용**: 4주 × 2명 = 8인주
- **인프라 비용**: 월 $100 (Supabase Pro)
- **유지보수**: 월 $50 (모니터링)

## 수익 모델
- **기본 플랜**: 월 $500 (지자체)
- **프리미엄 플랜**: 월 $1,000 (대형 행사)
- **엔터프라이즈**: 월 $2,000 (산업현장)

## 차별화 포인트
1. **유일한 완전 오프라인 우선 아키텍처**
2. **재난 상황에 특화된 설계**
3. **암호화된 로컬 저장 및 전송**
4. **우선순위 기반 큐잉 시스템**

이 솔루션은 재난 상황에서 가장 중요한 "신고 접수" 기능을 보장하여, 기존 서비스와 명확히 차별화된 가치를 제공합니다.
